{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>교보 DTS 지원</title>
    <link rel="stylesheet" href="{% static 'apply.css' %}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Easy<span>cruit</span></h1>
            <h2 name="applying_to" id="applying_to">[교보DTS] Cloud architecture DX Academy(CDA)</h2>
            <h3>참가신청서</h3>
        </div>

        <form id="application-form">
            <div class="form-section">
                <div class="form-group">
                    <label class="form-label">이름</label>
                    <input type="text" id="name" name="name" required class="form-input">
                </div>
                
                <div class="form-group">
                    <label class="form-label">주민번호 앞자리</label>
                    <input type="text" id="date_of_birth" name="date_of_birth" required class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">휴대전화</label>
                    <input type="tel" id="phone_num" name="phone_num" required class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">E-mail</label>
                    <input type="email" id="email" name="email" required class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">거주지</label>
                    <input type="text" id="residence" name="residence" required class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">학력사항</label>
                    <select name="educational_background" id="educational_background" required class="form-input">
                        <option value="" selected disabled>선택하세요</option>
                        <option value="고등학교 졸업">고등학교 졸업</option>
                        <option value="전문학사">전문학사</option>
                        <option value="대학 재학(졸업학점 이수 O)">대학 재학(졸업학점 이수 O)</option>
                        <option value="대학 재학(졸업학점 이수 X)">대학 재학(졸업학점 이수 X)</option>
                        <option value="학사">학사</option>
                        <option value="석사 이상">석사 이상</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">학교</label>
                    <input type="text" id="school" name="school" class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">전공학과</label>
                    <input type="text" id="major" name="major" class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">IT/클라우드 공인 관련 자격증</label>
                    <input type="text" id="certificate" name="certificate" class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">IT 관련 대회, 공모전, 대외활동</label>
                    <textarea name="it_experience" id="it_experience" rows="4" required class="form-input"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">유사교육 수료 경험</label>
                    <select name="education_experience" id="education_experience" class="form-input">
                        <option value="" selected disabled>선택하세요</option>
                        <option value="해당없음">해당없음</option>
                        <option value="1개월 미만">1개월 미만</option>
                        <option value="1개월 이상 ~ 3개월 미만">1개월 이상 ~ 3개월 미만</option>
                        <option value="3개월 이상">3개월 이상</option>
                    </select>
        
                </div>

                <div class="form-group">
                    <label class="form-label">IT 관련 업무 경험</label>
                    <select name="it_career_experience" id="it_career_experience" class="form-input">
                        <option value="" selected disabled>선택하세요</option>
                        <option value="해당없음">해당없음</option>
                        <option value="6개월 미만">6개월 미만</option>
                        <option value="6개월 ~ 1년">6개월 ~ 1년</option>
                        <option value="1년 ~ 2년">1년 ~ 2년</option>
                        <option value="2년 ~ 3년">2년 ~ 3년</option>
                        <option value="3년 이상">3년 이상</option>
                    </select>
            
                </div>
        
                <div class="checkbox-section">
                    <div class="form-group">
                        <label class="form-label">내일 배움카드 소지여부</label>
                        <div class="checkbox-group">
                            <div class="form-group">
                                <input type="checkbox" id="card_possession_has" name="card_possession" value="has" onclick="handleCheckbox(this)">
                                <label for="card_possession_has" class="inline-label">내일배움카드가 있습니다.</label>
                            </div>
                            <div class="form-group">
                                <input type="checkbox" id="card_possession_will_issue" name="card_possession" value="will-issue" onclick="handleCheckbox(this)">
                                <label for="card_possession_will_issue" class="inline-label">내일배움을 발급 받을 예정입니다.</label>
                            </div>
                        </div>
                    </div>
                </div>
                

            <div class="form-section">
                <div class="form-group">
                    <label class="form-label">지원동기 및 계획 (최소 50자 이상)</label>
                    <textarea id="motivation_career_plan" name="motivation_career_plan" rows="4" required class="form-input" style="resize: none;"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">신청 경로</label>
                    <select name="source_of_info" id="source_of_info" onchange="toggleOtherInput();" class="form-input">
                        <option value="" selected disabled>선택하세요</option>
                        <option value="네이버 검색">네이버 검색</option>
                        <option value="구글 검색">구글 검색</option>
                        <option value="네이버 배너 광고">네이버 배너 광고</option>
                        <option value="인스타그램">인스타그램</option>
                        <option value="유튜브e">유튜브</option>
                        <option value="블로그/카페/커뮤니티">블로그/카페/커뮤니티</option>
                        <option value="카카오톡 오픈채팅방">카카오톡 오픈채팅방</option>
                        <option value="메일">메일</option>
                        <option value="부트캠프">부트캠프</option>
                        <option value="뉴스기사">뉴스기사</option>
                        <option value="대학 캠퍼스/취창업센터">대학 캠퍼스/취창업센터</option>
                        <option value="지인추천(교보DTS 임직원)">지인추천(교보DTS 임직원)</option>
                        <option value="지인추천(기타)">지인추천(기타)</option>
                        <option value="자소설닷컴">자소설닷컴</option>
                        <option value="other">기타</option>
                    </select>
                    <input type="text" id="other-input" name="application-source-other" class="form-input" style="display: none;">
                </div>
            </div>

            <button type="submit" class="submit-button">제출 [ 2 / 2 ]</button>
        </form>
    </div>

<script>
    function handleCheckbox(checkbox) {
    // 같은 그룹의 체크박스 선택 해제
    const checkboxes = document.querySelectorAll('input[name="card_possession"]');
    checkboxes.forEach((cb) => {
        if (cb !== checkbox) {
            cb.checked = false;
        }
    });

    // 선택된 체크박스의 값을 변수에 저장
    if (checkbox.checked) {
        selectedCardPossession = checkbox.value === 'has' ? '내일배움카드가 있습니다.' : '내일배움카드를 발급 받을 예정입니다.';
    } else {
        selectedCardPossession = '';
    }
}


    function toggleOtherInput() {
        const applicationSource = document.getElementById('source_of_info');
        const otherInput = document.getElementById('other-input');
        otherInput.style.display = applicationSource.value === 'other' ? 'block' : 'none';
    }

    document.getElementById('application-form').addEventListener('submit', function(event) {
        event.preventDefault();


        // 폼 데이터 수집
        const applicationData = {
            applying_to: document.getElementById('applying_to').textContent,
            name: document.getElementById('name').value,
            date_of_birth: document.getElementById('date_of_birth').value,
            phone_num: document.getElementById('phone_num').value,
            email: document.getElementById('email').value,
            residence: document.getElementById('residence').value,
            educational_background: document.getElementById('educational_background').value,
            school: document.getElementById('school').value,
            major: document.getElementById('major').value,
            certificate: document.getElementById('certificate').value,
            it_experience: document.getElementById('it_experience').value,
            education_experience: document.getElementById('education_experience').value,
            it_career_experience: document.getElementById('it_career_experience').value,
            card_possession: selectedCardPossession,
            motivation_career_plan: document.getElementById('motivation_career_plan').value,
            source_of_info: document.getElementById('source_of_info').value === 'other' ? document.getElementById('other-input').value : document.getElementById('source_of_info').value
        };

        // Fetch API로 POST 요청 보내기
        fetch('/api/application/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(applicationData)
        })
        .then(response => {
            if (!response.ok) throw new Error("서버 오류");
            return response.json();
        })
        .then(data => {
            alert('신청이 성공적으로 제출되었습니다.');
            console.log(data);
        })
        .catch(error => {
            console.error('오류 발생:', error);
            alert('신청 제출 중 오류가 발생했습니다. 다시 시도해주세요.');
        });
    });
</script>
</body>
</html>
